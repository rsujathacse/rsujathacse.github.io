<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-aiml docs-version-current docs-doc-page docs-doc-id-build-retrieval-ready-doc-pipeline" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Build a Retrieval-Ready Documentation Pipeline on a Cloud VM | Sujatha R</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://rsujathacse.github.io/img/social-card.png"><meta data-rh="true" name="twitter:image" content="https://rsujathacse.github.io/img/social-card.png"><meta data-rh="true" property="og:url" content="https://rsujathacse.github.io/aiml/build-retrieval-ready-doc-pipeline/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-aiml-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-aiml-current"><meta data-rh="true" property="og:title" content="Build a Retrieval-Ready Documentation Pipeline on a Cloud VM | Sujatha R"><meta data-rh="true" name="description" content="Learn how to design and deploy a documentation pipeline optimized for both humans and AI retrieval systems using Docker, FastAPI, and a cloud VM."><meta data-rh="true" property="og:description" content="Learn how to design and deploy a documentation pipeline optimized for both humans and AI retrieval systems using Docker, FastAPI, and a cloud VM."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://rsujathacse.github.io/aiml/build-retrieval-ready-doc-pipeline/"><link data-rh="true" rel="alternate" href="https://rsujathacse.github.io/aiml/build-retrieval-ready-doc-pipeline/" hreflang="en"><link data-rh="true" rel="alternate" href="https://rsujathacse.github.io/aiml/build-retrieval-ready-doc-pipeline/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Build a Retrieval-Ready Documentation Pipeline on a Cloud VM","item":"https://rsujathacse.github.io/aiml/build-retrieval-ready-doc-pipeline"}]}</script><link rel="stylesheet" href="/assets/css/styles.79100536.css">
<script src="/assets/js/runtime~main.6a42fc53.js" defer="defer"></script>
<script src="/assets/js/main.5ae595e4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme","light"),document.documentElement.setAttribute("data-theme-choice","light"),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/sujathar.png"><link rel="preload" as="image" href="/img/aiml/doc-pipeline/create-droplet.png"><link rel="preload" as="image" href="/img/aiml/doc-pipeline/droplet-ip.png"><link rel="preload" as="image" href="/img/aiml/doc-pipeline/docker-installed.png"><link rel="preload" as="image" href="/img/aiml/doc-pipeline/health-endpoint.png"><link rel="preload" as="image" href="/img/aiml/doc-pipeline/deploy-md-structure.png"><link rel="preload" as="image" href="/img/aiml/doc-pipeline/chunks-generated.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/sujathar.png" alt="Sujatha R writer image" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/sujathar.png" alt="Sujatha R writer image" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Sujatha R</b></a><a class="navbar__item navbar__link" href="/aiml/intro/">AI/ML Docs</a><a class="navbar__item navbar__link" href="/docs/intro/">Docs</a><a class="navbar__item navbar__link" href="/apis/intro/">APIs</a><a class="navbar__item navbar__link" href="/architecture/intro/">Architecture</a><a class="navbar__item navbar__link" href="/strategy/intro/">Content Strategy</a><a class="navbar__item navbar__link" href="/experience/">Experience</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/aiml/intro/"><span title="AI/ML Docs" class="linkLabel_WmDU">AI/ML Docs</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/aiml/do-articles/"><span title="Articles I wrote for DigitalOcean" class="linkLabel_WmDU">Articles I wrote for DigitalOcean</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/aiml/build-retrieval-ready-doc-pipeline/"><span title="Build a Retrieval-Ready Documentation Pipeline on a Cloud VM" class="linkLabel_WmDU">Build a Retrieval-Ready Documentation Pipeline on a Cloud VM</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Build a Retrieval-Ready Documentation Pipeline on a Cloud VM</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Build a Retrieval-Ready Documentation Pipeline on a Cloud VM</h1></header>
<p>Modern documentation is no longer written just for humans. Search engines, internal knowledge bases, and Retrieval-Augmented Generation (RAG) systems now consume documentation as structured data. If your docs are not chunked, indexed, and enriched with metadata, AI systems cannot reliably retrieve or reason over them.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="how-this-tutorial-connects-to-rag-systems">How this tutorial connects to RAG systems<a href="#how-this-tutorial-connects-to-rag-systems" class="hash-link" aria-label="Direct link to How this tutorial connects to RAG systems" title="Direct link to How this tutorial connects to RAG systems" translate="no">​</a></h3>
<p>Retrieval-Augmented Generation (RAG) systems rely on well-structured, semantically clean source content. While most RAG tutorials focus on embeddings, vector databases, and query pipelines, they assume the underlying documentation is already retrieval-ready.</p>
<p>This tutorial addresses that foundational layer. Instead of building the retrieval engine itself, we design documentation in a way that makes it optimally consumable by retrieval systems. The structured chunks, stable section IDs, canonical URLs, and metadata we generate here are exactly what embedding pipelines and vector databases require downstream.</p>
<p>In other words, this workflow prepares documentation to perform reliably inside a RAG architecture.</p>
<p>In this tutorial, we will build a retrieval-ready documentation pipeline from scratch on a cloud VM. By the end, you will have:</p>
<ul>
<li class="">A deployed FastAPI service running on Docker</li>
<li class="">Markdown documentation structured with semantic section boundaries</li>
<li class="">A custom chunking script that converts documentation into machine-readable JSON</li>
<li class="">Retrieval-ready metadata including section IDs, canonical URLs, and word counts</li>
<li class="">A generated <code>chunks.json</code> artifact suitable for embeddings or RAG systems</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="what-this-tutorial-covers">What this tutorial covers<a href="#what-this-tutorial-covers" class="hash-link" aria-label="Direct link to What this tutorial covers" title="Direct link to What this tutorial covers" translate="no">​</a></h2>
<p>We will:</p>
<ol>
<li class="">Provision a cloud VM</li>
<li class="">Install Docker and Docker Compose</li>
<li class="">Deploy a simple API service</li>
<li class="">Author structured Markdown documentation</li>
<li class="">Build a Python chunking pipeline</li>
<li class="">Generate a retrieval-optimized JSON artifact</li>
</ol>
<p>The goal is to design documentation that can be consumed by:</p>
<ul>
<li class="">Humans</li>
<li class="">Search engines</li>
<li class="">Knowledge bases</li>
<li class="">RAG systems</li>
<li class="">AI agents</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="environment-details">Environment details<a href="#environment-details" class="hash-link" aria-label="Direct link to Environment details" title="Direct link to Environment details" translate="no">​</a></h2>
<p>This workflow was deployed in the following environment:</p>
<ul>
<li class="">Cloud provider: DigitalOcean</li>
<li class="">VM size: 2 vCPUs, 4GB RAM</li>
<li class="">OS: Ubuntu 24.04 LTS (x64)</li>
<li class="">Container runtime: Docker Engine 29.x</li>
<li class="">Orchestration: Docker Compose v5.x</li>
<li class="">API framework: FastAPI</li>
<li class="">Reverse proxy: Nginx</li>
<li class="">Python version: 3.11 (slim image)</li>
<li class="">Documentation format: Markdown (H2/H3 structured)</li>
<li class="">Output artifact: <code>chunks.json</code></li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites" translate="no">​</a></h2>
<p>Before starting, you should have:</p>
<ul>
<li class="">A cloud account (DigitalOcean or equivalent)</li>
<li class="">Basic Linux command line familiarity</li>
<li class="">Understanding of:<!-- -->
<ul>
<li class="">Docker fundamentals</li>
<li class="">Markdown structure</li>
<li class="">Basic Python scripting</li>
</ul>
</li>
<li class="">Ability to SSH into a VM</li>
<li class="">Local browser access to the cloud console</li>
</ul>
<p>Optional but recommended:</p>
<ul>
<li class="">Familiarity with RAG pipelines</li>
<li class="">Basic understanding of embeddings</li>
<li class="">Experience with FastAPI</li>
</ul>
<hr>
<p>In the next section, we will provision the VM and configure Docker.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="provisioning-the-cloud-vm-and-installing-docker">Provisioning the cloud VM and installing Docker<a href="#provisioning-the-cloud-vm-and-installing-docker" class="hash-link" aria-label="Direct link to Provisioning the cloud VM and installing Docker" title="Direct link to Provisioning the cloud VM and installing Docker" translate="no">​</a></h2>
<p>To build a retrieval-ready documentation pipeline, we first need a stable runtime environment. Instead of running everything locally, we deploy on a cloud VM to simulate a real-world production setup.</p>
<p>This ensures:</p>
<ul>
<li class="">Isolation from local machine constraints</li>
<li class="">Reproducibility</li>
<li class="">Network-level testing</li>
<li class="">Infrastructure realism</li>
</ul>
<hr>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="create-a-cloud-vm">Create a cloud VM<a href="#create-a-cloud-vm" class="hash-link" aria-label="Direct link to Create a cloud VM" title="Direct link to Create a cloud VM" translate="no">​</a></h3>
<p>Log in to your cloud provider dashboard and create a new virtual machine with the following configuration:</p>
<ul>
<li class="">OS: Ubuntu 24.04 LTS (x64)</li>
<li class="">Size: 2 vCPUs, 4GB RAM</li>
<li class="">Disk: 120GB</li>
<li class="">Authentication: SSH key</li>
<li class="">Monitoring: Optional (enabled for observability)</li>
</ul>
<figure style="text-align:center;margin:2rem 0"><img src="/img/aiml/doc-pipeline/create-droplet.png" alt="DigitalOcean droplet creation page" style="max-width:100%"><figcaption style="margin-top:0.75rem;font-size:0.9rem;color:#666"><p>DigitalOcean Droplet (VM) creation</p></figcaption></figure>
<p>Once provisioned, note the public IPv4 address.</p>
<figure style="text-align:center;margin:2rem 0"><img src="/img/aiml/doc-pipeline/droplet-ip.png" alt="DigitalOcean droplet IP address image" style="max-width:100%"><figcaption style="margin-top:0.75rem;font-size:0.9rem;color:#666"><p>Created a DigitalOcean Droplet</p></figcaption></figure>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="connect-to-the-vm">Connect to the VM<a href="#connect-to-the-vm" class="hash-link" aria-label="Direct link to Connect to the VM" title="Direct link to Connect to the VM" translate="no">​</a></h3>
<p>Use the web console or SSH:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh root@your_public_ip</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="install-docker-engine">Install Docker Engine<a href="#install-docker-engine" class="hash-link" aria-label="Direct link to Install Docker Engine" title="Direct link to Install Docker Engine" translate="no">​</a></h3>
<p>We install Docker directly from the official repository to ensure compatibility with the latest Compose plugin.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="update-system-packages">Update system packages<a href="#update-system-packages" class="hash-link" aria-label="Direct link to Update system packages" title="Direct link to Update system packages" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">apt-get update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apt-get install -y ca-certificates curl gnupg</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="add-dockers-official-gpg-key">Add Docker’s official GPG key<a href="#add-dockers-official-gpg-key" class="hash-link" aria-label="Direct link to Add Docker’s official GPG key" title="Direct link to Add Docker’s official GPG key" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">install -m 0755 -d /etc/apt/keyrings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -fsSL https://download.docker.com/linux/ubuntu/gpg | \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpg --dearmor -o /etc/apt/keyrings/docker.gpg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod a+r /etc/apt/keyrings/docker.gpg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Add Docker repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https://download.docker.com/linux/ubuntu \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$(. /etc/os-release &amp;&amp; echo &quot;$VERSION_CODENAME&quot;) stable&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; /etc/apt/sources.list.d/docker.list</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="install-docker-and-compose">Install Docker and Compose<a href="#install-docker-and-compose" class="hash-link" aria-label="Direct link to Install Docker and Compose" title="Direct link to Install Docker and Compose" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">apt-get update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apt-get install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enable and start Docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl enable docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl start docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Verify installation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker --version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker compose version</span><br></span></code></pre></div></div>
<figure style="text-align:center;margin:2rem 0"><img src="/img/aiml/doc-pipeline/docker-installed.png" alt="Terminal showing docker and docker compose versions" style="max-width:100%"><figcaption style="margin-top:0.75rem;font-size:0.9rem;color:#666"><p>Verifying Docker Engine and Docker Compose installation.</p></figcaption></figure>
<p>If both commands return version numbers successfully, Docker is correctly installed.</p>
<p>Why we use Docker instead of installing dependencies directly</p>
<p>Using Docker provides:</p>
<ul>
<li class="">
<p>Deterministic environments</p>
</li>
<li class="">
<p>Dependency isolation</p>
</li>
<li class="">
<p>Reproducible builds</p>
</li>
<li class="">
<p>Clean teardown and rebuild cycles</p>
</li>
<li class="">
<p>Production parity</p>
</li>
</ul>
<p>This matters because retrieval pipelines often evolve. You want the ability to:</p>
<ul>
<li class="">
<p>Rebuild services</p>
</li>
<li class="">
<p>Modify chunking logic</p>
</li>
<li class="">
<p>Reprocess documentation</p>
</li>
<li class="">
<p>Deploy changes quickly</p>
</li>
</ul>
<p>Containers make that workflow predictable.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="deploy-a-fastapi-service-with-docker-compose">Deploy a FastAPI service with Docker Compose<a href="#deploy-a-fastapi-service-with-docker-compose" class="hash-link" aria-label="Direct link to Deploy a FastAPI service with Docker Compose" title="Direct link to Deploy a FastAPI service with Docker Compose" translate="no">​</a></h2>
<p>Now that Docker is installed, we will deploy a simple FastAPI application inside a container using Docker Compose. This service will later be the foundation for testing our documentation and retrieval pipeline.</p>
<hr>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="create-the-project-directory">Create the project directory<a href="#create-the-project-directory" class="hash-link" aria-label="Direct link to Create the project directory" title="Direct link to Create the project directory" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p ~/rag-docs-demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd ~/rag-docs-demo</span><br></span></code></pre></div></div>
<p>This directory will contain:</p>
<ul>
<li class="">
<p>The FastAPI application</p>
</li>
<li class="">
<p>The Docker Compose configuration</p>
</li>
<li class="">
<p>Supporting documentation files</p>
</li>
<li class="">
<p>The chunking script</p>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="create-the-fastapi-application">Create the FastAPI application<a href="#create-the-fastapi-application" class="hash-link" aria-label="Direct link to Create the FastAPI application" title="Direct link to Create the FastAPI application" translate="no">​</a></h3>
<p>Create a file named main.py:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> main</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">py </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;PYEOF&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> fastapi </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> FastAPI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> FastAPI</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">title</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;Docs demo API&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@app</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;/health&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">health</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;status&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ok&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@app</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;/hello&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">hello</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;world&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;message&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;hello, </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">name</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PYEOF</span><br></span></code></pre></div></div>
<p>This application exposes two endpoints:</p>
<ul>
<li class="">
<p><code>/health</code> — used for service validation</p>
</li>
<li class="">
<p><code>/hello</code> — simple parameterized endpoint for testing</p>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="create-the-docker-compose-configuration">Create the Docker Compose configuration<a href="#create-the-docker-compose-configuration" class="hash-link" aria-label="Direct link to Create the Docker Compose configuration" title="Direct link to Create the Docker Compose configuration" translate="no">​</a></h3>
<p>Create a file named <code>docker-compose.yml</code>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat &gt; docker-compose.yml &lt;&lt; &#x27;YAMLEOF&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">services:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  api:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image: python:3.11-slim</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    command: sh -c &quot;pip install --no-cache-dir fastapi uvicorn &amp;&amp; uvicorn main:app --host 0.0.0.0 --port 8000&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - ./main.py:/main.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - &quot;8000:8000&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    restart: unless-stopped</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">YAMLEOF</span><br></span></code></pre></div></div>
<p>This configuration:</p>
<ul>
<li class="">
<p>Uses a lightweight Python 3.11 image</p>
</li>
<li class="">
<p>Installs FastAPI and Uvicorn at runtime</p>
</li>
<li class="">
<p>Mounts the local main.py file</p>
</li>
<li class="">
<p>Exposes port 8000</p>
</li>
<li class="">
<p>Enables automatic restart</p>
</li>
</ul>
<p>Start the service</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker compose up -d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker compose ps</span><br></span></code></pre></div></div>
<div class="language-mdx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-mdx codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;figure style={{ textAlign: &quot;center&quot;, margin: &quot;2rem 0&quot; }}&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;img</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  src=&quot;/img/aiml/doc-pipeline/docker-compose-running.png&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alt=&quot;Docker compose ps output showing running FastAPI container&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  style={{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    maxWidth: &quot;100%&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;figcaption style={{ marginTop: &quot;0.75rem&quot;, fontSize: &quot;0.9rem&quot;, color: &quot;#666&quot; }}&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  FastAPI service running inside Docker.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/figcaption&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/figure&gt;</span><br></span></code></pre></div></div>
<p>You should see the api container in a running state.</p>
<p>Verify the API is reachable</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl http://localhost:8000/health</span><br></span></code></pre></div></div>
<p>Expected response:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;status&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;ok&quot;</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<figure style="text-align:center;margin:2rem 0"><img src="/img/aiml/doc-pipeline/health-endpoint.png" alt="Terminal showing successful curl response from health endpoint" style="max-width:100%"><figcaption style="margin-top:0.75rem;font-size:0.9rem;color:#666"> Verifying the API health endpoint. </figcaption></figure>
<p>If you receive a JSON response with &quot;status&quot;:&quot;ok&quot;, the service is correctly deployed.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="authoring-documentation-for-retrieval-systems">Authoring documentation for retrieval systems<a href="#authoring-documentation-for-retrieval-systems" class="hash-link" aria-label="Direct link to Authoring documentation for retrieval systems" title="Direct link to Authoring documentation for retrieval systems" translate="no">​</a></h2>
<p>At this point, the API is running. Instead of immediately building embeddings or a vector database, we focus on something more foundational:</p>
<p>Designing documentation that retrieval systems can understand.</p>
<p>Most RAG implementations fail not because of the model — but because the source content is poorly structured.</p>
<p>In this section, we will:</p>
<ul>
<li class="">Create structured Markdown documentation</li>
<li class="">Use H2 for logical grouping</li>
<li class="">Use H3 as retrieval boundaries</li>
<li class="">Add stable section anchors</li>
<li class="">Prepare content for deterministic chunk extraction</li>
</ul>
<hr>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="create-a-documentation-directory">Create a documentation directory<a href="#create-a-documentation-directory" class="hash-link" aria-label="Direct link to Create a documentation directory" title="Direct link to Create a documentation directory" translate="no">​</a></h3>
<p>From the project root:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir docs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd docs</span><br></span></code></pre></div></div>
<p>This directory will contain all documentation files that will later be parsed into retrieval-ready chunks.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="create-the-deployment-documentation-file">Create the deployment documentation file<a href="#create-the-deployment-documentation-file" class="hash-link" aria-label="Direct link to Create the deployment documentation file" title="Direct link to Create the deployment documentation file" translate="no">​</a></h3>
<p>Create a file named <code>deploy.md</code>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nano deploy.md</span><br></span></code></pre></div></div>
<p>Add the following structure:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Deploy the API with Docker Compose</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Create the project directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Create the working directory on the Droplet</span><br></span></code></pre></div></div>
<p>This step creates the folder that contains the API source file and the Docker Compose configuration.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p ~/rag-docs-demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd ~/rag-docs-demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Verify the directory exists</span><br></span></code></pre></div></div>
<p>Expected behavior: the directory is created without errors.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="create-the-api-source-file">Create the API source file<a href="#create-the-api-source-file" class="hash-link" aria-label="Direct link to Create the API source file" title="Direct link to Create the API source file" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="define-the-fastapi-application">Define the FastAPI application<a href="#define-the-fastapi-application" class="hash-link" aria-label="Direct link to Define the FastAPI application" title="Direct link to Define the FastAPI application" translate="no">​</a></h4>
<p>This application exposes two endpoints: <code>/health</code> and <code>/hello</code>.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat &gt; main.py &lt;&lt; &#x27;PYEOF&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from fastapi import FastAPI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app = FastAPI(title=&quot;Docs demo API&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@app.get(&quot;/health&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def health():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return {&quot;status&quot;: &quot;ok&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@app.get(&quot;/hello&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def hello(name: str = &quot;world&quot;):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return {&quot;message&quot;: f&quot;hello, {name}&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PYEOF</span><br></span></code></pre></div></div>
<p>Start the service
Run Docker Compose</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker compose up -d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker compose ps</span><br></span></code></pre></div></div>
<p>Verify the API is reachable</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl http://localhost:8000/health</span><br></span></code></pre></div></div>
<p>Expected response:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;status&quot;:&quot;ok&quot;}</span><br></span></code></pre></div></div>
<hr>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="why-this-structure-matters">Why this structure matters<a href="#why-this-structure-matters" class="hash-link" aria-label="Direct link to Why this structure matters" title="Direct link to Why this structure matters" translate="no">​</a></h3>
<p>We intentionally use:</p>
<ul>
<li class="">H2 for major task grouping</li>
<li class="">H3 for granular answer boundaries</li>
</ul>
<p>Each H3 section will become one retrieval chunk.</p>
<p>This ensures:</p>
<ul>
<li class="">Clean semantic boundaries</li>
<li class="">Better embedding precision</li>
<li class="">Reduced hallucination risk</li>
<li class="">Deterministic citation mapping</li>
</ul>
<hr>
<figure style="text-align:center;margin:2rem 0"><img src="/img/aiml/doc-pipeline/deploy-md-structure.png" alt="Structured Markdown file with H2 and H3 boundaries" style="max-width:100%"><figcaption style="margin-top:0.75rem;font-size:0.9rem;color:#666"><p>Structured Markdown with H2 grouping and H3 retrieval boundaries.</p></figcaption></figure>
<hr>
<p>In the next section, we will build a Python script that parses this Markdown and converts it into retrieval-ready JSON chunks.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="converting-structured-markdown-into-retrieval-ready-chunks">Converting structured Markdown into retrieval-ready chunks<a href="#converting-structured-markdown-into-retrieval-ready-chunks" class="hash-link" aria-label="Direct link to Converting structured Markdown into retrieval-ready chunks" title="Direct link to Converting structured Markdown into retrieval-ready chunks" translate="no">​</a></h2>
<p>Now that we have structured documentation, the next step is to transform it into machine-readable chunks.</p>
<p>Retrieval systems do not consume Markdown directly. They require:</p>
<ul>
<li class="">Clean content boundaries</li>
<li class="">Stable section identifiers</li>
<li class="">Canonical URLs</li>
<li class="">Metadata enrichment</li>
<li class="">Structured JSON output</li>
</ul>
<p>In this section, we will build a lightweight Python script that:</p>
<ol>
<li class="">Parses Markdown files</li>
<li class="">Splits content by H3 boundaries</li>
<li class="">Generates stable section IDs</li>
<li class="">Attaches canonical URLs</li>
<li class="">Exports structured JSON</li>
</ol>
<hr>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="create-the-chunking-script">Create the chunking script<a href="#create-the-chunking-script" class="hash-link" aria-label="Direct link to Create the chunking script" title="Direct link to Create the chunking script" translate="no">​</a></h3>
<p>Return to the project root:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd ~/rag-docs-demo</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="create-a-new-file">Create a new file:<a href="#create-a-new-file" class="hash-link" aria-label="Direct link to Create a new file:" title="Direct link to Create a new file:" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nano chunk_docs.py</span><br></span></code></pre></div></div>
<p>Paste the following code:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> re</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DOCS_DIR </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;docs&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">slugify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">r&#x27;[^a-z0-9]+&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;-&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lower</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">strip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;-&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parse_markdown</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">file_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">file_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;r&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        lines </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">readlines</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Remove H1 lines</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lines </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">line </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> line </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> lines </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> line</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">startswith</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;# &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sections </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    current_section </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">buffer</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> line </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> lines</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> line</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">startswith</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;### &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> current_section</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                sections</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;section_title&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> current_section</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;title&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;section_id&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> current_section</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;id&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;content&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">strip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token builtin">buffer</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            title </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> line</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">strip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;### &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">strip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            current_section </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&quot;title&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> title</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&quot;id&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> slugify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">title</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> line</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">startswith</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;## &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># H2 headings act as grouping only</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">continue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">buffer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">line</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> current_section</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sections</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;section_title&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> current_section</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;title&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;section_id&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> current_section</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;id&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;content&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">strip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> sections</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    all_chunks </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    base_url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://your-docs-domain.com&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> filename </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">listdir</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">DOCS_DIR</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> filename</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">endswith</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;.md&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            path </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">DOCS_DIR</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> filename</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sections </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> parse_markdown</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> section </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> sections</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                content_text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> section</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;content&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                word_count </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">content_text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                chunk </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;doc&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> filename</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;section_title&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> section</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;section_title&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;section_id&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> section</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;section_id&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;url&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">base_url</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">/</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">filename</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">#</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">section</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&#x27;section_id&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;word_count&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> word_count</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;content&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> content_text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                all_chunks</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">chunk</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;chunks.json&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;w&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dump</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">all_chunks</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> indent</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Chunk file generated: chunks.json&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>Save and exit.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="run-the-chunking-script">Run the chunking script<a href="#run-the-chunking-script" class="hash-link" aria-label="Direct link to Run the chunking script" title="Direct link to Run the chunking script" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 chunk_docs.py</span><br></span></code></pre></div></div>
<p>If successful, you should see:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Chunk file generated: chunks.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Inspect the generated artifact</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">head -n 40 chunks.json</span><br></span></code></pre></div></div>
<p>You should see structured JSON similar to:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;doc&quot;: &quot;deploy.md&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;section_title&quot;: &quot;Create the working directory on the Droplet&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;section_id&quot;: &quot;create-the-working-directory-on-the-droplet&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;url&quot;: &quot;http://your-docs-domain.com/deploy.md#create-the-working-directory-on-the-droplet&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;word_count&quot;: 28,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;content&quot;: &quot;...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<figure style="text-align:center;margin:2rem 0"><img src="/img/aiml/doc-pipeline/chunks-generated.png" alt="Terminal showing chunks.json file generated successfully" style="max-width:100%"><figcaption style="margin-top:0.75rem;font-size:0.9rem;color:#666"><p>Retrieval-ready JSON artifact generated from structured Markdown.</p></figcaption></figure>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="why-h3-based-chunking-improves-retrieval">Why H3-based chunking improves retrieval<a href="#why-h3-based-chunking-improves-retrieval" class="hash-link" aria-label="Direct link to Why H3-based chunking improves retrieval" title="Direct link to Why H3-based chunking improves retrieval" translate="no">​</a></h3>
<p>We intentionally chunk at the H3 level instead of H2.</p>
<p>This provides:</p>
<ul>
<li class="">
<p>Smaller semantic units</p>
</li>
<li class="">
<p>More precise embedding vectors</p>
</li>
<li class="">
<p>Better retrieval recall</p>
</li>
<li class="">
<p>Reduced hallucination risk</p>
</li>
<li class="">
<p>Deterministic citation mapping</p>
</li>
</ul>
<p>H2 headings remain logical grouping boundaries for humans, while H3 headings become retrieval boundaries for machines.</p>
<p>At this point, your documentation is officially retrieval-ready.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="future-scope">Future scope<a href="#future-scope" class="hash-link" aria-label="Direct link to Future scope" title="Direct link to Future scope" translate="no">​</a></h3>
<p>This tutorial stops at the retrieval-ready artifact stage. From here, you can extend the system in several directions:</p>
<ul>
<li class="">Generate embeddings from <code>chunks.json</code> using an embedding model</li>
<li class="">Store vectors in a database such as pgvector or Elasticsearch</li>
<li class="">Build a semantic search endpoint on top of the stored vectors</li>
<li class="">Integrate an LLM to generate grounded responses</li>
<li class="">Add citation-aware response formatting using section IDs</li>
</ul>
<p>These extensions transform this pipeline into a full RAG system.</p>
<p>However, without structured and deterministic chunking, even the best models and databases will struggle.</p>
<p>By designing documentation for retrieval first, you create a strong foundation for any AI-powered knowledge system.</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/aiml/do-articles/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Articles I wrote for DigitalOcean</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#how-this-tutorial-connects-to-rag-systems" class="table-of-contents__link toc-highlight">How this tutorial connects to RAG systems</a></li><li><a href="#what-this-tutorial-covers" class="table-of-contents__link toc-highlight">What this tutorial covers</a></li><li><a href="#environment-details" class="table-of-contents__link toc-highlight">Environment details</a></li><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#provisioning-the-cloud-vm-and-installing-docker" class="table-of-contents__link toc-highlight">Provisioning the cloud VM and installing Docker</a><ul><li><a href="#create-a-cloud-vm" class="table-of-contents__link toc-highlight">Create a cloud VM</a></li><li><a href="#connect-to-the-vm" class="table-of-contents__link toc-highlight">Connect to the VM</a></li><li><a href="#install-docker-engine" class="table-of-contents__link toc-highlight">Install Docker Engine</a></li></ul></li><li><a href="#deploy-a-fastapi-service-with-docker-compose" class="table-of-contents__link toc-highlight">Deploy a FastAPI service with Docker Compose</a><ul><li><a href="#create-the-project-directory" class="table-of-contents__link toc-highlight">Create the project directory</a></li><li><a href="#create-the-fastapi-application" class="table-of-contents__link toc-highlight">Create the FastAPI application</a></li><li><a href="#create-the-docker-compose-configuration" class="table-of-contents__link toc-highlight">Create the Docker Compose configuration</a></li></ul></li><li><a href="#authoring-documentation-for-retrieval-systems" class="table-of-contents__link toc-highlight">Authoring documentation for retrieval systems</a><ul><li><a href="#create-a-documentation-directory" class="table-of-contents__link toc-highlight">Create a documentation directory</a></li><li><a href="#create-the-deployment-documentation-file" class="table-of-contents__link toc-highlight">Create the deployment documentation file</a></li><li><a href="#create-the-api-source-file" class="table-of-contents__link toc-highlight">Create the API source file</a></li><li><a href="#why-this-structure-matters" class="table-of-contents__link toc-highlight">Why this structure matters</a></li></ul></li><li><a href="#converting-structured-markdown-into-retrieval-ready-chunks" class="table-of-contents__link toc-highlight">Converting structured Markdown into retrieval-ready chunks</a><ul><li><a href="#create-the-chunking-script" class="table-of-contents__link toc-highlight">Create the chunking script</a></li><li><a href="#why-h3-based-chunking-improves-retrieval" class="table-of-contents__link toc-highlight">Why H3-based chunking improves retrieval</a></li><li><a href="#future-scope" class="table-of-contents__link toc-highlight">Future scope</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/in/rsujathatech/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/rsujathacse" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="mailto:rsujathacse@gmail.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Email<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/talks/writing-the-future/">My talk(s)</a></li><li class="footer__item"><a href="#" class="footer__link-item">© 2026 Sujatha R</a></li></ul></div></div></div></footer></div>
</body>
</html>
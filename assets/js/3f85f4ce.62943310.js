"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[83],{6385(e,n,i){i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"secure-security-event-ingestion-api","title":"Designing and Documenting a Secure Security Event Ingestion API","description":"Build and document a production-ready security event ingestion API with authentication, rate limiting, idempotency, and durable storage using FastAPI.","source":"@site/docs/apis/secure-security-event-ingestion-api.md","sourceDirName":".","slug":"/secure-security-event-ingestion-api","permalink":"/apis/secure-security-event-ingestion-api","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"title":"Designing and Documenting a Secure Security Event Ingestion API","sidebar_position":1,"description":"Build and document a production-ready security event ingestion API with authentication, rate limiting, idempotency, and durable storage using FastAPI."},"sidebar":"apisSidebar","previous":{"title":"APIs","permalink":"/apis/intro"}}');var s=i(4848),r=i(8453);const a={title:"Designing and Documenting a Secure Security Event Ingestion API",sidebar_position:1,description:"Build and document a production-ready security event ingestion API with authentication, rate limiting, idempotency, and durable storage using FastAPI."},l="Designing and Documenting a Secure Security Event Ingestion API",d={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Skills",id:"skills",level:3},{value:"Tools",id:"tools",level:3},{value:"What You Will Build",id:"what-you-will-build",level:2},{value:"Project Structure",id:"project-structure",level:2},{value:"Step 1: Define the event schema",id:"step-1-define-the-event-schema",level:2},{value:"Step 2: Database initialization (SQLite)",id:"step-2-database-initialization-sqlite",level:2},{value:"Step 3: API key authentication",id:"step-3-api-key-authentication",level:2},{value:"Step 4: Rate limiting",id:"step-4-rate-limiting",level:2},{value:"Step 5: API Implementation",id:"step-5-api-implementation",level:2},{value:"Base URL",id:"base-url",level:2},{value:"Swagger UI",id:"swagger-ui",level:2},{value:"Health Check",id:"health-check",level:2},{value:"Ingest an Event via CLI",id:"ingest-an-event-via-cli",level:2},{value:"Using Swagger \u201cTry it out\u201d",id:"using-swagger-try-it-out",level:2},{value:"Successful Response",id:"successful-response",level:2},{value:"Data Persistence",id:"data-persistence",level:2},{value:"Error model",id:"error-model",level:2},{value:"OpenAPI snippet",id:"openapi-snippet",level:2},{value:"Operational considerations",id:"operational-considerations",level:2},{value:"Security enhancements",id:"security-enhancements",level:2},{value:"Scalability improvements",id:"scalability-improvements",level:2},{value:"Observability and monitoring",id:"observability-and-monitoring",level:2},{value:"Functional extensions",id:"functional-extensions",level:2},{value:"Deployment enhancements",id:"deployment-enhancements",level:2}];function o(e){const n={blockquote:"blockquote",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"designing-and-documenting-a-secure-security-event-ingestion-api",children:"Designing and Documenting a Secure Security Event Ingestion API"})}),"\n",(0,s.jsx)(n.p,{children:"Security teams need a reliable way to collect events from applications, services, and infrastructure \u2014 and later query those events for investigations, alerting, and audit trails."}),"\n",(0,s.jsxs)(n.p,{children:["A ",(0,s.jsx)(n.strong,{children:"security event ingestion API"})," accepts structured event payloads over HTTP, validates them, stores them durably, and makes them easy to troubleshoot when things go wrong."]}),"\n",(0,s.jsx)(n.p,{children:"This guide walks through building a production-minded ingestion API with:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Strict schema validation"}),"\n",(0,s.jsx)(n.li,{children:"Authentication using API keys"}),"\n",(0,s.jsx)(n.li,{children:"Rate limiting"}),"\n",(0,s.jsx)(n.li,{children:"Idempotency support"}),"\n",(0,s.jsx)(n.li,{children:"Durable event storage (SQLite for local development)"}),"\n",(0,s.jsxs)(n.li,{children:["CLI-based testing (",(0,s.jsx)(n.code,{children:"curl"}),")"]}),"\n",(0,s.jsx)(n.li,{children:"OpenAPI-ready documentation (Swagger UI)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"In this article, we design and implement:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"A secure event ingestion API using FastAPI. We define a strict event schema, enforce authentication with API keys, apply rate limiting to protect the endpoint, and persist events to a local database."}),"\n",(0,s.jsx)(n.li,{children:"We then document the API using OpenAPI (Swagger UI) and demonstrate how to test it via both CLI and interactive documentation."}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsx)(n.h3,{id:"skills",children:"Skills"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Basic REST API concepts (methods, status codes, JSON)"}),"\n",(0,s.jsx)(n.li,{children:"Comfortable using the command line"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"tools",children:"Tools"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Python 3.11+"}),"\n",(0,s.jsx)(n.li,{children:"Git"}),"\n",(0,s.jsx)(n.li,{children:"curl"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"what-you-will-build",children:"What You Will Build"}),"\n",(0,s.jsx)(n.p,{children:"By the end of this guide, you will have implemented the following endpoints:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Endpoint"}),(0,s.jsx)(n.th,{children:"Purpose"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"POST /v1/events"})}),(0,s.jsx)(n.td,{children:"Ingest a single security event"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"GET /healthz"})}),(0,s.jsx)(n.td,{children:"Health check"})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"project-structure",children:"Project Structure"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"siem-event-api/\n\u2514\u2500\u2500 app/\n    \u251c\u2500\u2500 main.py\n    \u251c\u2500\u2500 schemas.py\n    \u251c\u2500\u2500 db.py\n    \u251c\u2500\u2500 auth.py\n    \u2514\u2500\u2500 rate_limit.py\n"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Note \u2014 Development environment"})}),"\n",(0,s.jsxs)(n.p,{children:["This API was implemented and tested inside ",(0,s.jsx)(n.strong,{children:"GitHub Codespaces"}),", which automatically forwards application ports and provides a cloud-based development environment."]}),"\n",(0,s.jsx)(n.p,{children:"You can alternatively run this project in:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"A local development environment (macOS, Linux, Windows with Python installed)"}),"\n",(0,s.jsxs)(n.li,{children:["A virtual environment using ",(0,s.jsx)(n.code,{children:"venv"})," or Conda"]}),"\n",(0,s.jsx)(n.li,{children:"Docker (containerized FastAPI + database setup)"}),"\n",(0,s.jsx)(n.li,{children:"A cloud VM (e.g., AWS EC2, Google Compute Engine, DigitalOcean Droplet)"}),"\n",(0,s.jsx)(n.li,{children:"A managed container platform (e.g., Google Cloud Run, DigitalOcean, AWS ECS, Azure Container Apps)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The core application logic remains unchanged across environments. But the hosting setup differs."}),"\n"]}),"\n",(0,s.jsx)(n.h1,{id:"implementation",children:"Implementation"}),"\n",(0,s.jsx)(n.h2,{id:"step-1-define-the-event-schema",children:"Step 1: Define the event schema"}),"\n",(0,s.jsxs)(n.p,{children:["Create ",(0,s.jsx)(n.code,{children:"app/schemas.py"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'from pydantic import BaseModel, Field\nfrom typing import Dict, Any, Optional, Literal\nfrom datetime import datetime\nimport uuid\n\nclass SecurityEvent(BaseModel):\n    event_id: str = Field(default_factory=lambda: str(uuid.uuid4()))\n    timestamp: datetime\n    source: str\n    environment: Literal["dev", "staging", "prod"] = "prod"\n    severity: Literal["low", "medium", "high", "critical"] = "medium"\n    category: str\n    action: str\n    actor: Dict[str, Any]\n    target: Optional[Dict[str, Any]] = None\n    ip: Optional[str] = None\n    user_agent: Optional[str] = None\n    metadata: Dict[str, Any] = {}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"step-2-database-initialization-sqlite",children:"Step 2: Database initialization (SQLite)"}),"\n",(0,s.jsx)(n.p,{children:"For local development, we use SQLite for simplicity."}),"\n",(0,s.jsxs)(n.p,{children:["Create ",(0,s.jsx)(n.code,{children:"app/db.py"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'import sqlite3\n\nDATABASE = "events.db"\n\ndef get_conn():\n    return sqlite3.connect(DATABASE)\n\ndef init_db():\n    with get_conn() as conn:\n        conn.execute("""\n        CREATE TABLE IF NOT EXISTS events (\n            event_id TEXT PRIMARY KEY,\n            timestamp TEXT NOT NULL,\n            source TEXT NOT NULL,\n            environment TEXT NOT NULL,\n            severity TEXT NOT NULL,\n            category TEXT NOT NULL,\n            action TEXT NOT NULL,\n            actor TEXT NOT NULL,\n            metadata TEXT NOT NULL,\n            request_id TEXT,\n            idempotency_key TEXT\n        );\n        """)\n'})}),"\n",(0,s.jsx)(n.h2,{id:"step-3-api-key-authentication",children:"Step 3: API key authentication"}),"\n",(0,s.jsxs)(n.p,{children:["Create ",(0,s.jsx)(n.code,{children:"app/auth.py"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'import os\nfrom fastapi import Header, HTTPException\n\nAPI_KEY = "change-me"\n\ndef require_api_key(x_api_key: str = Header(default="")):\n    if x_api_key != API_KEY:\n        raise HTTPException(status_code=401, detail="Invalid or missing API key.")\n'})}),"\n",(0,s.jsx)(n.h2,{id:"step-4-rate-limiting",children:"Step 4: Rate limiting"}),"\n",(0,s.jsxs)(n.p,{children:["Create ",(0,s.jsx)(n.code,{children:"app/rate_limit.py"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'import time\nfrom fastapi import HTTPException\n\nWINDOW_SEC = 60\nMAX_REQ = 60\n_hits = {}\n\ndef rate_limit(key: str):\n    now = time.time()\n    window_start, count = _hits.get(key, (now, 0))\n\n    if now - window_start > WINDOW_SEC:\n        window_start, count = now, 0\n\n    count += 1\n    _hits[key] = (window_start, count)\n\n    if count > MAX_REQ:\n        raise HTTPException(status_code=429, detail="Rate limit exceeded.")\n'})}),"\n",(0,s.jsx)(n.h2,{id:"step-5-api-implementation",children:"Step 5: API Implementation"}),"\n",(0,s.jsxs)(n.p,{children:["Create ",(0,s.jsx)(n.code,{children:"app/main.py"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'from fastapi import FastAPI, Depends, Header\nfrom typing import Optional\nimport uuid\nimport json\n\nfrom schemas import SecurityEvent\nfrom db import init_db, get_conn\nfrom auth import require_api_key\nfrom rate_limit import rate_limit\n\napp = FastAPI(title="Security Event Ingestion API")\n\n@app.on_event("startup")\ndef startup():\n    init_db()\n\n@app.get("/healthz")\ndef healthz():\n    return {"status": "ok"}\n\n@app.post("/v1/events")\ndef ingest_event(\n    event: SecurityEvent,\n    _auth=Depends(require_api_key),\n    x_request_id: Optional[str] = Header(default=None),\n    idempotency_key: Optional[str] = Header(default=None),\n):\n    rate_limit("global")\n    request_id = x_request_id or str(uuid.uuid4())\n\n    with get_conn() as conn:\n        conn.execute("""\n            INSERT OR IGNORE INTO events (\n                event_id, timestamp, source, environment,\n                severity, category, action, actor, metadata,\n                request_id, idempotency_key\n            )\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n        """, (\n            event.event_id,\n            event.timestamp.isoformat(),\n            event.source,\n            event.environment,\n            event.severity,\n            event.category,\n            event.action,\n            json.dumps(event.actor),\n            json.dumps(event.metadata),\n            request_id,\n            idempotency_key\n        ))\n\n    return {"status": "ok", "event_id": event.event_id, "request_id": request_id}\n'})}),"\n",(0,s.jsx)(n.h1,{id:"running-the-api",children:"Running the API"}),"\n",(0,s.jsx)(n.p,{children:"Start the server:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"uvicorn app.main:app --host 0.0.0.0 --port 8000\n"})}),"\n",(0,s.jsx)(n.p,{children:"Once executed, Uvicorn starts the FastAPI application and listens on port 8000."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"API startup success",src:i(3172).A+"",width:"1509",height:"231"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"Uvicorn startup logs confirming the API server is running."})}),"\n",(0,s.jsxs)(n.p,{children:["Uvicorn loads the FastAPI application defined in app.main",":app"," and binds it to port 8000. FastAPI is an ASGI application. Uvicorn acts as the ASGI server that handles incoming HTTP requests."]}),"\n",(0,s.jsx)(n.h1,{id:"api-reference",children:"API Reference"}),"\n",(0,s.jsx)(n.h2,{id:"base-url",children:"Base URL"}),"\n",(0,s.jsx)(n.p,{children:"When running inside GitHub Codespaces, the API is exposed via a forwarded HTTPS URL. This forwarded URL securely exposes port 8000 to the browser."}),"\n",(0,s.jsxs)(n.p,{children:["Example: https://",(0,s.jsx)(n.code,{children:"<codespace-name>"}),"-8000.app.github.dev"]}),"\n",(0,s.jsx)(n.h2,{id:"swagger-ui",children:"Swagger UI"}),"\n",(0,s.jsxs)(n.p,{children:["Visit: https://",(0,s.jsx)(n.code,{children:"<codespace-name>"}),"-8000.app.github.dev/docs"]}),"\n",(0,s.jsx)(n.p,{children:"FastAPI automatically generates interactive OpenAPI documentation using Swagger UI."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Swagger UI overview",src:i(2354).A+"",width:"1891",height:"996"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"Interactive OpenAPI documentation generated automatically by FastAPI in a GitHub Codespaces environment."})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Swagger UI loaded successfully"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"API endpoints listed and interactive"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)("strong",{children:"What we can we see in the SwaggerUI?"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"API title"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"GET /healthz"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"POST /v1/events"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Schema definitions"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"When Uvicorn binds to 0.0.0.0:8000, Codespaces detects the open port and automatically:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Forwards it"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Assigns a public HTTPS URL"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Secures it behind GitHub authentication"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Codespaces automatically forwards ports to allow browser access to services running inside the container. This replaces localhost with a secure external URL."}),"\n",(0,s.jsx)(n.h2,{id:"health-check",children:"Health Check"}),"\n",(0,s.jsx)(n.p,{children:"When running inside GitHub Codespaces, the API is exposed via a forwarded HTTPS URL."}),"\n",(0,s.jsx)(n.p,{children:"To verify that the API is reachable, use the forwarded domain:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"curl https://`<codespace-name>`-8000.app.github.dev/healthz\n"})}),"\n",(0,s.jsx)(n.p,{children:"Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"curl https://silver-invention-5gg44rw9956cv4v-8000.app.github.dev/healthz\n"})}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"/healthz"})," endpoint returns a simple JSON response. Health endpoints allow monitoring systems or load balancers to verify service availability. If the API is running correctly, the response will be:\n",(0,s.jsx)(n.img,{alt:"Json status ok image",src:i(2554).A+"",width:"1234",height:"141"})]}),"\n",(0,s.jsx)(n.h2,{id:"ingest-an-event-via-cli",children:"Ingest an Event via CLI"}),"\n",(0,s.jsx)(n.p,{children:"Send a structured security event to the ingestion endpoint:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl -X POST http://localhost:8000/v1/events \\\n  -H "Content-Type: application/json" \\\n  -H "X-API-Key: change-me" \\\n  -d \'{\n    "timestamp":"2026-02-17T10:10:10Z",\n    "source":"auth-service",\n    "environment":"prod",\n    "severity":"high",\n    "category":"auth",\n    "action":"login_failed",\n    "actor":{"type":"user","id":"u-123"},\n    "metadata":{}\n  }\'\n'})}),"\n",(0,s.jsx)(n.p,{children:"The API:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Validates the request body using Pydantic."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Checks the API key."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Applies rate limiting."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Inserts the event into the database."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"POST /v1/events"})," route processes incoming events and ensures:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Schema correctness"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Authentication enforcement"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Controlled request rate"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Durable storage"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"CLI event ingestion image",src:i(5175).A+"",width:"1787",height:"258"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"Successful event ingestion using curl."})}),"\n",(0,s.jsx)(n.h2,{id:"using-swagger-try-it-out",children:"Using Swagger \u201cTry it out\u201d"}),"\n",(0,s.jsx)(n.p,{children:"Swagger allows interactive testing without using curl. The same POST request is executed via the browser. Swagger UI uses the OpenAPI spec to generate a form-based interface that sends HTTP requests."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Swagger try it out payload image",src:i(6491).A+"",width:"1877",height:"893"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"Submitting a structured event payload directly from Swagger UI."})}),"\n",(0,s.jsx)(n.h2,{id:"successful-response",children:"Successful Response"}),"\n",(0,s.jsx)(n.p,{children:"After executing via Swagger, the server processes the event and returns a structured success response."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Swagger 200 response image",src:i(5175).A+"",width:"1787",height:"258"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"Successful 200 OK response including event_id."})}),"\n",(0,s.jsx)(n.h2,{id:"data-persistence",children:"Data Persistence"}),"\n",(0,s.jsx)(n.p,{children:"After successful ingestion:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ls -l\n"})}),"\n",(0,s.jsxs)(n.p,{children:["SQLite creates events.db in the project directory. The database is initialized on application startup and writes events to disk. Confirmation that events are stored durably:\n",(0,s.jsx)(n.img,{alt:"Database file created",src:i(6634).A+"",width:"1267",height:"239"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"SQLite database file created locally after event ingestion."})}),"\n",(0,s.jsx)(n.h2,{id:"error-model",children:"Error model"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Status code"}),(0,s.jsx)(n.th,{children:"Meaning"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"401"}),(0,s.jsx)(n.td,{children:"Unauthorized"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"422"}),(0,s.jsx)(n.td,{children:"Validation Error"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"429"}),(0,s.jsx)(n.td,{children:"Rate Limit Exceeded"})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"openapi-snippet",children:"OpenAPI snippet"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"paths:\n  /v1/events:\n    post:\n      summary: Ingest a security event\n      responses:\n        '200':\n          description: Event ingested successfully\n        '401':\n          description: Unauthorized\n"})}),"\n",(0,s.jsx)(n.h2,{id:"operational-considerations",children:"Operational considerations"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Step"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Use idempotency keys for safe retries"}),(0,s.jsx)(n.td,{children:"Prevents duplicate event ingestion if the client retries the same request due to network failures or timeouts. Ensures safe reprocessing without creating multiple records."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Log request IDs for traceability"}),(0,s.jsx)(n.td,{children:"Enables end-to-end request tracking across systems, making debugging, auditing, and incident investigation easier."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Replace in-memory rate limiting with Redis in production"}),(0,s.jsx)(n.td,{children:"Moves rate limiting to a distributed store so limits are enforced consistently across multiple API instances in horizontally scaled environments."})]})]})]}),"\n",(0,s.jsx)(n.h1,{id:"future-scope",children:"Future scope"}),"\n",(0,s.jsx)(n.p,{children:"While this guide focuses on local development and architectural clarity, these below improvement points outline the path toward building a production-ready security event ingestion system."}),"\n",(0,s.jsx)(n.h2,{id:"security-enhancements",children:"Security enhancements"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Replace API keys with OAuth2 or mTLS"}),(0,s.jsx)(n.br,{}),"\n","Implement token-based authentication or mutual TLS for stronger service-to-service trust."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Role-Based Access Control (RBAC)"}),(0,s.jsx)(n.br,{}),"\n","Restrict event ingestion and retrieval based on service identity or tenant permissions."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Request Signature Validation"}),(0,s.jsx)(n.br,{}),"\n","Add HMAC or signed payload verification to prevent tampering and replay attacks."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"TLS Enforcement and Certificate Management"}),(0,s.jsx)(n.br,{}),"\n","Ensure encrypted communication using managed certificates in production."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"scalability-improvements",children:"Scalability improvements"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Replace SQLite with a Production Database"}),(0,s.jsx)(n.br,{}),"\n","Use PostgreSQL, a managed database service, or distributed storage for higher durability and performance."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Introduce Message Queues"}),(0,s.jsx)(n.br,{}),"\n","Add Kafka, Pub/Sub, or similar systems to buffer and stream high-volume events."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Distributed Rate Limiting"}),(0,s.jsx)(n.br,{}),"\n","Replace in-memory rate limiting with Redis or an API gateway-based limiter."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Horizontal Scaling"}),(0,s.jsx)(n.br,{}),"\n","Deploy behind a load balancer or container orchestration platform such as Kubernetes."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"observability-and-monitoring",children:"Observability and monitoring"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Structured Logging"}),(0,s.jsx)(n.br,{}),"\n","Add structured logs for ingestion activity and failures."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Metrics and Monitoring"}),(0,s.jsx)(n.br,{}),"\n","Expose Prometheus metrics for ingestion rates, error rates, and latency."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Audit Logging"}),(0,s.jsx)(n.br,{}),"\n","Maintain immutable audit trails for compliance and forensic investigations."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"functional-extensions",children:"Functional extensions"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Event Retrieval APIs"}),(0,s.jsx)(n.br,{}),"\n","Implement filtered search endpoints for querying events by severity, category, or time range."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Schema Versioning"}),(0,s.jsx)(n.br,{}),"\n","Support backward-compatible schema evolution for event payloads."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Multi-Tenant Isolation"}),(0,s.jsx)(n.br,{}),"\n","Separate event storage and access control across tenants or customers."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"deployment-enhancements",children:"Deployment enhancements"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Containerization"}),(0,s.jsx)(n.br,{}),"\n","Package the application using Docker for portable deployment."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cloud Deployment"}),(0,s.jsx)(n.br,{}),"\n","Deploy to managed platforms such as Google Cloud Run, AWS ECS, or DigitalOcean App Platform."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Infrastructure as Code (IaC)"}),(0,s.jsx)(n.br,{}),"\n","Use Terraform or similar tools to provision production infrastructure."]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},5175(e,n,i){i.d(n,{A:()=>t});const t=i.p+"assets/images/200-event-id-763fcfc34ab978bd673528af0a95d198.png"},6634(e,n,i){i.d(n,{A:()=>t});const t=i.p+"assets/images/events.db-created-9c9dc6e90dd64ce395b242baac02dff8.png"},2554(e,n,i){i.d(n,{A:()=>t});const t=i.p+"assets/images/json-status-ok-32ead15185bdbd07153c98ffffcae662.png"},2354(e,n,i){i.d(n,{A:()=>t});const t=i.p+"assets/images/swagger-overview-eb02c123ce6233cde2e86604806f94f6.png"},6491(e,n,i){i.d(n,{A:()=>t});const t=i.p+"assets/images/try-it-out-payload-6f1ed001fffedf7e3cba3d38a8dd0c70.png"},3172(e,n,i){i.d(n,{A:()=>t});const t=i.p+"assets/images/uvicorn-1b20a5b8f12fb9874b42c2d7a8298ca5.png"},8453(e,n,i){i.d(n,{R:()=>a,x:()=>l});var t=i(6540);const s={},r=t.createContext(s);function a(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);
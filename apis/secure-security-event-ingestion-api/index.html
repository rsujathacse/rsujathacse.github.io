<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-apis docs-version-current docs-doc-page docs-doc-id-secure-security-event-ingestion-api" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Designing and Documenting a Secure Security Event Ingestion API | I write technical docs that move products from evaluation → adoption → revenue.</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://rsujathacse.github.io/img/social-card.png"><meta data-rh="true" name="twitter:image" content="https://rsujathacse.github.io/img/social-card.png"><meta data-rh="true" property="og:url" content="https://rsujathacse.github.io/apis/secure-security-event-ingestion-api/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-apis-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-apis-current"><meta data-rh="true" property="og:title" content="Designing and Documenting a Secure Security Event Ingestion API | I write technical docs that move products from evaluation → adoption → revenue."><meta data-rh="true" name="description" content="Build and document a production-ready security event ingestion API with authentication, rate limiting, idempotency, and durable storage using FastAPI."><meta data-rh="true" property="og:description" content="Build and document a production-ready security event ingestion API with authentication, rate limiting, idempotency, and durable storage using FastAPI."><link data-rh="true" rel="icon" href="/img/sujathar.png"><link data-rh="true" rel="canonical" href="https://rsujathacse.github.io/apis/secure-security-event-ingestion-api/"><link data-rh="true" rel="alternate" href="https://rsujathacse.github.io/apis/secure-security-event-ingestion-api/" hreflang="en"><link data-rh="true" rel="alternate" href="https://rsujathacse.github.io/apis/secure-security-event-ingestion-api/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Designing and Documenting a Secure Security Event Ingestion API","item":"https://rsujathacse.github.io/apis/secure-security-event-ingestion-api"}]}</script><link rel="stylesheet" href="/assets/css/styles.a3638ebf.css">
<script src="/assets/js/runtime~main.767ba6e7.js" defer="defer"></script>
<script src="/assets/js/main.d38f8bd7.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme","light"),document.documentElement.setAttribute("data-theme-choice","light"),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/sujathar.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/sujathar.png" alt="Sujatha R writer image" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/sujathar.png" alt="Sujatha R writer image" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Sujatha R</b></a><a class="navbar__item navbar__link" href="/aiml/intro/">AI/ML Docs</a><a class="navbar__item navbar__link" href="/docs/intro/">Docs</a><a class="navbar__item navbar__link" href="/apis/intro/">APIs</a><a class="navbar__item navbar__link" href="/experience/">Experience</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/apis/intro/"><span title="APIs" class="linkLabel_WmDU">APIs</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/apis/secure-security-event-ingestion-api/"><span title="Designing and Documenting a Secure Security Event Ingestion API" class="linkLabel_WmDU">Designing and Documenting a Secure Security Event Ingestion API</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Designing and Documenting a Secure Security Event Ingestion API</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Designing and Documenting a Secure Security Event Ingestion API</h1></header>
<p>Security teams need a reliable way to collect events from applications, services, and infrastructure — and later query those events for investigations, alerting, and audit trails.</p>
<p>A <strong>security event ingestion API</strong> accepts structured event payloads over HTTP, validates them, stores them durably, and makes them easy to troubleshoot when things go wrong.</p>
<p>This guide walks through building a production-minded ingestion API with:</p>
<ul>
<li class="">Strict schema validation</li>
<li class="">Authentication using API keys</li>
<li class="">Rate limiting</li>
<li class="">Idempotency support</li>
<li class="">Durable event storage (SQLite for local development)</li>
<li class="">CLI-based testing (<code>curl</code>)</li>
<li class="">OpenAPI-ready documentation (Swagger UI)</li>
</ul>
<p>In this article, we design and implement:</p>
<ul>
<li class="">A secure event ingestion API using FastAPI. We define a strict event schema, enforce authentication with API keys, apply rate limiting to protect the endpoint, and persist events to a local database.</li>
<li class="">We then document the API using OpenAPI (Swagger UI) and demonstrate how to test it via both CLI and interactive documentation.</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="skills">Skills<a href="#skills" class="hash-link" aria-label="Direct link to Skills" title="Direct link to Skills" translate="no">​</a></h3>
<ul>
<li class="">Basic REST API concepts (methods, status codes, JSON)</li>
<li class="">Comfortable using the command line</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="tools">Tools<a href="#tools" class="hash-link" aria-label="Direct link to Tools" title="Direct link to Tools" translate="no">​</a></h3>
<ul>
<li class="">Python 3.11+</li>
<li class="">Git</li>
<li class="">curl</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="what-you-will-build">What You Will Build<a href="#what-you-will-build" class="hash-link" aria-label="Direct link to What You Will Build" title="Direct link to What You Will Build" translate="no">​</a></h2>
<p>By the end of this guide, you will have implemented the following endpoints:</p>
<table><thead><tr><th>Endpoint</th><th>Purpose</th></tr></thead><tbody><tr><td><code>POST /v1/events</code></td><td>Ingest a single security event</td></tr><tr><td><code>GET /healthz</code></td><td>Health check</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="project-structure">Project Structure<a href="#project-structure" class="hash-link" aria-label="Direct link to Project Structure" title="Direct link to Project Structure" translate="no">​</a></h2>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">siem-event-api/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── app/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── main.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── schemas.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── db.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── auth.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └── rate_limit.py</span><br></span></code></pre></div></div>
<blockquote>
<p><strong>Note — Development environment</strong></p>
<p>This API was implemented and tested inside <strong>GitHub Codespaces</strong>, which automatically forwards application ports and provides a cloud-based development environment.</p>
<p>You can alternatively run this project in:</p>
<ul>
<li class="">A local development environment (macOS, Linux, Windows with Python installed)</li>
<li class="">A virtual environment using <code>venv</code> or Conda</li>
<li class="">Docker (containerized FastAPI + database setup)</li>
<li class="">A cloud VM (e.g., AWS EC2, Google Compute Engine, DigitalOcean Droplet)</li>
<li class="">A managed container platform (e.g., Google Cloud Run, DigitalOcean, AWS ECS, Azure Container Apps)</li>
</ul>
<p>The core application logic remains unchanged across environments. But the hosting setup differs.</p>
</blockquote>
<h1>Implementation</h1>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-1-define-the-event-schema">Step 1: Define the event schema<a href="#step-1-define-the-event-schema" class="hash-link" aria-label="Direct link to Step 1: Define the event schema" title="Direct link to Step 1: Define the event schema" translate="no">​</a></h2>
<p>Create <code>app/schemas.py</code>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> pydantic </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> BaseModel</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Field</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> typing </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Dict</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Literal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> datetime </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> datetime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> uuid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">SecurityEvent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">BaseModel</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    event_id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Field</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">default_factory</span><span class="token operator" style="color:#393A34">=</span><span class="token keyword" style="color:#00009f">lambda</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uuid</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">uuid4</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    timestamp</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> datetime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    source</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    environment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Literal</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;dev&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;staging&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;prod&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;prod&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    severity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Literal</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;low&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;medium&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;high&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;critical&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;medium&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    category</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    action</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    actor</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    target</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ip</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    user_agent</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-2-database-initialization-sqlite">Step 2: Database initialization (SQLite)<a href="#step-2-database-initialization-sqlite" class="hash-link" aria-label="Direct link to Step 2: Database initialization (SQLite)" title="Direct link to Step 2: Database initialization (SQLite)" translate="no">​</a></h2>
<p>For local development, we use SQLite for simplicity.</p>
<p>Create <code>app/db.py</code>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> sqlite3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DATABASE </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;events.db&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">get_conn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> sqlite3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">DATABASE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">init_db</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> get_conn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> conn</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        conn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        CREATE TABLE IF NOT EXISTS events (</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            event_id TEXT PRIMARY KEY,</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            timestamp TEXT NOT NULL,</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            source TEXT NOT NULL,</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            environment TEXT NOT NULL,</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            severity TEXT NOT NULL,</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            category TEXT NOT NULL,</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            action TEXT NOT NULL,</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            actor TEXT NOT NULL,</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            metadata TEXT NOT NULL,</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            request_id TEXT,</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            idempotency_key TEXT</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        &quot;&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-3-api-key-authentication">Step 3: API key authentication<a href="#step-3-api-key-authentication" class="hash-link" aria-label="Direct link to Step 3: API key authentication" title="Direct link to Step 3: API key authentication" translate="no">​</a></h2>
<p>Create <code>app/auth.py</code>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> fastapi </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Header</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> HTTPException</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">API_KEY </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;change-me&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require_api_key</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x_api_key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Header</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">default</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> x_api_key </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> API_KEY</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">raise</span><span class="token plain"> HTTPException</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">status_code</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">401</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> detail</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;Invalid or missing API key.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-4-rate-limiting">Step 4: Rate limiting<a href="#step-4-rate-limiting" class="hash-link" aria-label="Direct link to Step 4: Rate limiting" title="Direct link to Step 4: Rate limiting" translate="no">​</a></h2>
<p>Create <code>app/rate_limit.py</code>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> fastapi </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> HTTPException</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WINDOW_SEC </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">60</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MAX_REQ </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">60</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_hits </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">rate_limit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    now </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">time</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    window_start</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> count </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> _hits</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">now</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> now </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> window_start </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> WINDOW_SEC</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        window_start</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> count </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> now</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    count </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _hits</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">window_start</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> count</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> count </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> MAX_REQ</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">raise</span><span class="token plain"> HTTPException</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">status_code</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">429</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> detail</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;Rate limit exceeded.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-5-api-implementation">Step 5: API Implementation<a href="#step-5-api-implementation" class="hash-link" aria-label="Direct link to Step 5: API Implementation" title="Direct link to Step 5: API Implementation" translate="no">​</a></h2>
<p>Create <code>app/main.py</code>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> fastapi </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> FastAPI</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Depends</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Header</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> typing </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Optional</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> uuid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> schemas </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> SecurityEvent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> db </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> init_db</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> get_conn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> auth </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> require_api_key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> rate_limit </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> rate_limit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> FastAPI</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">title</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;Security Event Ingestion API&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@app</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">on_event</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;startup&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">startup</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    init_db</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@app</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;/healthz&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">healthz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;status&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ok&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@app</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;/v1/events&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ingest_event</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    event</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> SecurityEvent</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _auth</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Depends</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">require_api_key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    x_request_id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Header</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">default</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    idempotency_key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Header</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">default</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rate_limit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;global&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    request_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> x_request_id </span><span class="token keyword" style="color:#00009f">or</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uuid</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">uuid4</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> get_conn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> conn</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        conn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            INSERT OR IGNORE INTO events (</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">                event_id, timestamp, source, environment,</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">                severity, category, action, actor, metadata,</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">                request_id, idempotency_key</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            )</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        &quot;&quot;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">event_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">timestamp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isoformat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">environment</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">severity</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">category</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">action</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dumps</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">actor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dumps</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">metadata</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            request_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            idempotency_key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;status&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ok&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;event_id&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">event_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;request_id&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> request_id</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h1>Running the API</h1>
<p>Start the server:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">uvicorn app.main:app --host 0.0.0.0 --port 8000</span><br></span></code></pre></div></div>
<p>Once executed, Uvicorn starts the FastAPI application and listens on port 8000.</p>
<hr>
<p><img decoding="async" loading="lazy" alt="API startup success" src="/assets/images/uvicorn-1b20a5b8f12fb9874b42c2d7a8298ca5.png" width="1509" height="231" class="img_ev3q"></p>
<p><em>Uvicorn startup logs confirming the API server is running.</em></p>
<p>Uvicorn loads the FastAPI application defined in app.main<!-- -->:app<!-- --> and binds it to port 8000. FastAPI is an ASGI application. Uvicorn acts as the ASGI server that handles incoming HTTP requests.</p>
<h1>API Reference</h1>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="base-url">Base URL<a href="#base-url" class="hash-link" aria-label="Direct link to Base URL" title="Direct link to Base URL" translate="no">​</a></h2>
<p>When running inside GitHub Codespaces, the API is exposed via a forwarded HTTPS URL. This forwarded URL securely exposes port 8000 to the browser.</p>
<p>Example: https://<code>&lt;codespace-name&gt;</code>-8000.app.github.dev</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="swagger-ui">Swagger UI<a href="#swagger-ui" class="hash-link" aria-label="Direct link to Swagger UI" title="Direct link to Swagger UI" translate="no">​</a></h2>
<p>Visit: https://<code>&lt;codespace-name&gt;</code>-8000.app.github.dev/docs</p>
<p>FastAPI automatically generates interactive OpenAPI documentation using Swagger UI.</p>
<p><img decoding="async" loading="lazy" alt="Swagger UI overview" src="/assets/images/swagger-overview-eb02c123ce6233cde2e86604806f94f6.png" width="1891" height="996" class="img_ev3q"></p>
<p><em>Interactive OpenAPI documentation generated automatically by FastAPI in a GitHub Codespaces environment.</em></p>
<ul>
<li class="">
<p>Swagger UI loaded successfully</p>
</li>
<li class="">
<p>API endpoints listed and interactive</p>
</li>
</ul>
<strong>What we can we see in the SwaggerUI?</strong>
<ul>
<li class="">
<p>API title</p>
</li>
<li class="">
<p><code>GET /healthz</code></p>
</li>
<li class="">
<p><code>POST /v1/events</code></p>
</li>
<li class="">
<p>Schema definitions</p>
</li>
</ul>
<p>When Uvicorn binds to 0.0.0.0:8000, Codespaces detects the open port and automatically:</p>
<ul>
<li class="">
<p>Forwards it</p>
</li>
<li class="">
<p>Assigns a public HTTPS URL</p>
</li>
<li class="">
<p>Secures it behind GitHub authentication</p>
</li>
</ul>
<p>Codespaces automatically forwards ports to allow browser access to services running inside the container. This replaces localhost with a secure external URL.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="health-check">Health Check<a href="#health-check" class="hash-link" aria-label="Direct link to Health Check" title="Direct link to Health Check" translate="no">​</a></h2>
<p>When running inside GitHub Codespaces, the API is exposed via a forwarded HTTPS URL.</p>
<p>To verify that the API is reachable, use the forwarded domain:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl https://`&lt;codespace-name&gt;`-8000.app.github.dev/healthz</span><br></span></code></pre></div></div>
<p>Example:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl https://silver-invention-5gg44rw9956cv4v-8000.app.github.dev/healthz</span><br></span></code></pre></div></div>
<p>The <code>/healthz</code> endpoint returns a simple JSON response. Health endpoints allow monitoring systems or load balancers to verify service availability. If the API is running correctly, the response will be:
<img decoding="async" loading="lazy" alt="Json status ok image" src="/assets/images/json-status-ok-32ead15185bdbd07153c98ffffcae662.png" width="1234" height="141" class="img_ev3q"></p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="ingest-an-event-via-cli">Ingest an Event via CLI<a href="#ingest-an-event-via-cli" class="hash-link" aria-label="Direct link to Ingest an Event via CLI" title="Direct link to Ingest an Event via CLI" translate="no">​</a></h2>
<p>Send a structured security event to the ingestion endpoint:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -X POST http://localhost:8000/v1/events \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -H &quot;Content-Type: application/json&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -H &quot;X-API-Key: change-me&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d &#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;timestamp&quot;:&quot;2026-02-17T10:10:10Z&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;source&quot;:&quot;auth-service&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;environment&quot;:&quot;prod&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;severity&quot;:&quot;high&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;category&quot;:&quot;auth&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;action&quot;:&quot;login_failed&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;actor&quot;:{&quot;type&quot;:&quot;user&quot;,&quot;id&quot;:&quot;u-123&quot;},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;metadata&quot;:{}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }&#x27;</span><br></span></code></pre></div></div>
<p>The API:</p>
<ul>
<li class="">
<p>Validates the request body using Pydantic.</p>
</li>
<li class="">
<p>Checks the API key.</p>
</li>
<li class="">
<p>Applies rate limiting.</p>
</li>
<li class="">
<p>Inserts the event into the database.</p>
</li>
</ul>
<p>The <code>POST /v1/events</code> route processes incoming events and ensures:</p>
<ul>
<li class="">
<p>Schema correctness</p>
</li>
<li class="">
<p>Authentication enforcement</p>
</li>
<li class="">
<p>Controlled request rate</p>
</li>
<li class="">
<p>Durable storage</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" alt="CLI event ingestion image" src="/assets/images/200-event-id-763fcfc34ab978bd673528af0a95d198.png" width="1787" height="258" class="img_ev3q"></p>
<p><em>Successful event ingestion using curl.</em></p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="using-swagger-try-it-out">Using Swagger “Try it out”<a href="#using-swagger-try-it-out" class="hash-link" aria-label="Direct link to Using Swagger “Try it out”" title="Direct link to Using Swagger “Try it out”" translate="no">​</a></h2>
<p>Swagger allows interactive testing without using curl. The same POST request is executed via the browser. Swagger UI uses the OpenAPI spec to generate a form-based interface that sends HTTP requests.</p>
<p><img decoding="async" loading="lazy" alt="Swagger try it out payload image" src="/assets/images/try-it-out-payload-6f1ed001fffedf7e3cba3d38a8dd0c70.png" width="1877" height="893" class="img_ev3q"></p>
<p><em>Submitting a structured event payload directly from Swagger UI.</em></p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="successful-response">Successful Response<a href="#successful-response" class="hash-link" aria-label="Direct link to Successful Response" title="Direct link to Successful Response" translate="no">​</a></h2>
<p>After executing via Swagger, the server processes the event and returns a structured success response.</p>
<p><img decoding="async" loading="lazy" alt="Swagger 200 response image" src="/assets/images/200-event-id-763fcfc34ab978bd673528af0a95d198.png" width="1787" height="258" class="img_ev3q"></p>
<p><em>Successful 200 OK response including event_id.</em></p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="data-persistence">Data Persistence<a href="#data-persistence" class="hash-link" aria-label="Direct link to Data Persistence" title="Direct link to Data Persistence" translate="no">​</a></h2>
<p>After successful ingestion:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls -l</span><br></span></code></pre></div></div>
<p>SQLite creates events.db in the project directory. The database is initialized on application startup and writes events to disk. Confirmation that events are stored durably:
<img decoding="async" loading="lazy" alt="Database file created" src="/assets/images/events.db-created-9c9dc6e90dd64ce395b242baac02dff8.png" width="1267" height="239" class="img_ev3q"></p>
<p><em>SQLite database file created locally after event ingestion.</em></p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="error-model">Error model<a href="#error-model" class="hash-link" aria-label="Direct link to Error model" title="Direct link to Error model" translate="no">​</a></h2>
<table><thead><tr><th>Status code</th><th>Meaning</th></tr></thead><tbody><tr><td>401</td><td>Unauthorized</td></tr><tr><td>422</td><td>Validation Error</td></tr><tr><td>429</td><td>Rate Limit Exceeded</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="openapi-snippet">OpenAPI snippet<a href="#openapi-snippet" class="hash-link" aria-label="Direct link to OpenAPI snippet" title="Direct link to OpenAPI snippet" translate="no">​</a></h2>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">paths</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">/v1/events</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">post</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">summary</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Ingest a security event</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">responses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">&#x27;200&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">description</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Event ingested successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">&#x27;401&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">description</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Unauthorized</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="operational-considerations">Operational considerations<a href="#operational-considerations" class="hash-link" aria-label="Direct link to Operational considerations" title="Direct link to Operational considerations" translate="no">​</a></h2>
<table><thead><tr><th>Step</th><th>Description</th></tr></thead><tbody><tr><td>Use idempotency keys for safe retries</td><td>Prevents duplicate event ingestion if the client retries the same request due to network failures or timeouts. Ensures safe reprocessing without creating multiple records.</td></tr><tr><td>Log request IDs for traceability</td><td>Enables end-to-end request tracking across systems, making debugging, auditing, and incident investigation easier.</td></tr><tr><td>Replace in-memory rate limiting with Redis in production</td><td>Moves rate limiting to a distributed store so limits are enforced consistently across multiple API instances in horizontally scaled environments.</td></tr></tbody></table>
<h1>Future scope</h1>
<p>While this guide focuses on local development and architectural clarity, these below improvement points outline the path toward building a production-ready security event ingestion system.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="security-enhancements">Security enhancements<a href="#security-enhancements" class="hash-link" aria-label="Direct link to Security enhancements" title="Direct link to Security enhancements" translate="no">​</a></h2>
<ul>
<li class="">
<p><strong>Replace API keys with OAuth2 or mTLS</strong><br>
<!-- -->Implement token-based authentication or mutual TLS for stronger service-to-service trust.</p>
</li>
<li class="">
<p><strong>Role-Based Access Control (RBAC)</strong><br>
<!-- -->Restrict event ingestion and retrieval based on service identity or tenant permissions.</p>
</li>
<li class="">
<p><strong>Request Signature Validation</strong><br>
<!-- -->Add HMAC or signed payload verification to prevent tampering and replay attacks.</p>
</li>
<li class="">
<p><strong>TLS Enforcement and Certificate Management</strong><br>
<!-- -->Ensure encrypted communication using managed certificates in production.</p>
</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="scalability-improvements">Scalability improvements<a href="#scalability-improvements" class="hash-link" aria-label="Direct link to Scalability improvements" title="Direct link to Scalability improvements" translate="no">​</a></h2>
<ul>
<li class="">
<p><strong>Replace SQLite with a Production Database</strong><br>
<!-- -->Use PostgreSQL, a managed database service, or distributed storage for higher durability and performance.</p>
</li>
<li class="">
<p><strong>Introduce Message Queues</strong><br>
<!-- -->Add Kafka, Pub/Sub, or similar systems to buffer and stream high-volume events.</p>
</li>
<li class="">
<p><strong>Distributed Rate Limiting</strong><br>
<!-- -->Replace in-memory rate limiting with Redis or an API gateway-based limiter.</p>
</li>
<li class="">
<p><strong>Horizontal Scaling</strong><br>
<!-- -->Deploy behind a load balancer or container orchestration platform such as Kubernetes.</p>
</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="observability-and-monitoring">Observability and monitoring<a href="#observability-and-monitoring" class="hash-link" aria-label="Direct link to Observability and monitoring" title="Direct link to Observability and monitoring" translate="no">​</a></h2>
<ul>
<li class="">
<p><strong>Structured Logging</strong><br>
<!-- -->Add structured logs for ingestion activity and failures.</p>
</li>
<li class="">
<p><strong>Metrics and Monitoring</strong><br>
<!-- -->Expose Prometheus metrics for ingestion rates, error rates, and latency.</p>
</li>
<li class="">
<p><strong>Audit Logging</strong><br>
<!-- -->Maintain immutable audit trails for compliance and forensic investigations.</p>
</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="functional-extensions">Functional extensions<a href="#functional-extensions" class="hash-link" aria-label="Direct link to Functional extensions" title="Direct link to Functional extensions" translate="no">​</a></h2>
<ul>
<li class="">
<p><strong>Event Retrieval APIs</strong><br>
<!-- -->Implement filtered search endpoints for querying events by severity, category, or time range.</p>
</li>
<li class="">
<p><strong>Schema Versioning</strong><br>
<!-- -->Support backward-compatible schema evolution for event payloads.</p>
</li>
<li class="">
<p><strong>Multi-Tenant Isolation</strong><br>
<!-- -->Separate event storage and access control across tenants or customers.</p>
</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="deployment-enhancements">Deployment enhancements<a href="#deployment-enhancements" class="hash-link" aria-label="Direct link to Deployment enhancements" title="Direct link to Deployment enhancements" translate="no">​</a></h2>
<ul>
<li class="">
<p><strong>Containerization</strong><br>
<!-- -->Package the application using Docker for portable deployment.</p>
</li>
<li class="">
<p><strong>Cloud Deployment</strong><br>
<!-- -->Deploy to managed platforms such as Google Cloud Run, AWS ECS, or DigitalOcean App Platform.</p>
</li>
<li class="">
<p><strong>Infrastructure as Code (IaC)</strong><br>
<!-- -->Use Terraform or similar tools to provision production infrastructure.</p>
</li>
</ul></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/apis/intro/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">APIs</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a><ul><li><a href="#skills" class="table-of-contents__link toc-highlight">Skills</a></li><li><a href="#tools" class="table-of-contents__link toc-highlight">Tools</a></li></ul></li><li><a href="#what-you-will-build" class="table-of-contents__link toc-highlight">What You Will Build</a></li><li><a href="#project-structure" class="table-of-contents__link toc-highlight">Project Structure</a></li><li><a href="#step-1-define-the-event-schema" class="table-of-contents__link toc-highlight">Step 1: Define the event schema</a></li><li><a href="#step-2-database-initialization-sqlite" class="table-of-contents__link toc-highlight">Step 2: Database initialization (SQLite)</a></li><li><a href="#step-3-api-key-authentication" class="table-of-contents__link toc-highlight">Step 3: API key authentication</a></li><li><a href="#step-4-rate-limiting" class="table-of-contents__link toc-highlight">Step 4: Rate limiting</a></li><li><a href="#step-5-api-implementation" class="table-of-contents__link toc-highlight">Step 5: API Implementation</a></li><li><a href="#base-url" class="table-of-contents__link toc-highlight">Base URL</a></li><li><a href="#swagger-ui" class="table-of-contents__link toc-highlight">Swagger UI</a></li><li><a href="#health-check" class="table-of-contents__link toc-highlight">Health Check</a></li><li><a href="#ingest-an-event-via-cli" class="table-of-contents__link toc-highlight">Ingest an Event via CLI</a></li><li><a href="#using-swagger-try-it-out" class="table-of-contents__link toc-highlight">Using Swagger “Try it out”</a></li><li><a href="#successful-response" class="table-of-contents__link toc-highlight">Successful Response</a></li><li><a href="#data-persistence" class="table-of-contents__link toc-highlight">Data Persistence</a></li><li><a href="#error-model" class="table-of-contents__link toc-highlight">Error model</a></li><li><a href="#openapi-snippet" class="table-of-contents__link toc-highlight">OpenAPI snippet</a></li><li><a href="#operational-considerations" class="table-of-contents__link toc-highlight">Operational considerations</a></li><li><a href="#security-enhancements" class="table-of-contents__link toc-highlight">Security enhancements</a></li><li><a href="#scalability-improvements" class="table-of-contents__link toc-highlight">Scalability improvements</a></li><li><a href="#observability-and-monitoring" class="table-of-contents__link toc-highlight">Observability and monitoring</a></li><li><a href="#functional-extensions" class="table-of-contents__link toc-highlight">Functional extensions</a></li><li><a href="#deployment-enhancements" class="table-of-contents__link toc-highlight">Deployment enhancements</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/in/rsujathatech/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/rsujathacse" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="mailto:rsujathacse@gmail.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Email<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/talks/writing-the-future/">My talk(s)</a></li><li class="footer__item"><a href="#" class="footer__link-item">© 2026 Sujatha R</a></li></ul></div></div></div></footer></div>
</body>
</html>